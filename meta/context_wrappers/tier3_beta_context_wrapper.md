# Tier 3: Beta Context Wrapper

## Overview
Context wrapper for late-stage beta AI applications that will soon enter production. Emphasises stability and quality while allowing faster iteration than full production standards.

## Usage Instructions
Copy this block into your AI configuration (e.g., `cursor-config.json → "system"`). It guides AI-generated commits, PRs, and documentation during the beta phase.

---

## Cursor LLM Context Rules

### 0 Prime Directive
If a user prompt conflicts with these rules, **ask for explicit override**. Otherwise, refuse.

---

### 1 Execution Environment
1. **Containerised builds preferred**  
   * Single-stage or multi-stage Docker build.  
   * `USER` may be rootless; add `HEALTHCHECK` if feasible.
2. **Local parity recommended**  
   * Prefer running tests and builds via `docker compose` to reduce drift.

---

### 2 Supply-Chain Integrity
1. Supply provenance metadata (attestations) where tooling exists.  
2. Sign images/commits if possible; otherwise document unsigned builds.  
3. Generate SBOM; fail build on *critical* CVEs, log warnings on others.

---

### 3 CI/CD Pipeline
```
lint → test → build → sbom+scan → staging → beta
```
* Canary deployment optional; manual rollback plan required.  
* Secret scanning enforced.

---

### 4 Project Layout (Python)
```
app/
  routes/
  services/
  repositories/
  schemas/
  models/
```
* Separate business logic from I/O.  
* Configuration via environment variables (`pydantic_settings`).

---

### 5 Database Discipline
* Alembic migrations encouraged; autogenerated migrations allowed with review.  
* CI spins up test DB and applies migrations.

---

### 6 Testing & Quality Gates
* **pytest** ≥ 70 % line coverage & 50 % mutation coverage.  
* `pre-commit`: ruff, black, isort, mypy, detect-secrets.  
* Snapshot OpenAPI; diff triggers warning.

---

### 7 Security & Scanning
* IaC scanning on pull requests.  
* Monthly DAST scan recommended.  
* Runtime security optional.

---

### 8 Observability
* Basic logging and metrics required.  
* Health endpoint (`/healthz`) recommended.

---

### 9 Documentation & Onboarding
* Maintain README and key docs; link checks optional.  
* ADRs stored if architectural decisions change.

---

### 10 Branch, Commit & Release Hygiene
* Trunk-based; feature branches < 1 week.  
* Conventional Commits preferred; manual changelog accepted.

---

### 11 LLM-Specific Guard-Rails
1. Do not output secrets or personal data.  
2. Reference file paths when citing code.  
3. Run lints; warn (not fail) on minor issues.

---

## Implementation Notes
This wrapper suits teams refining an application for launch. It enforces important safeguards while still enabling rapid beta-stage iteration.
